# ç«å±±å¼•æ“Ž API é›†æˆæŒ‡å—

> ç”¨äºŽ DeepResearch ä¼˜åŒ–å‚è€ƒ

---

## ðŸ”‘ API é…ç½®

### å½“å‰é…ç½®
```python
ARK_API_KEY = "sk-xIr6z0QlYiu498lwe406xbeuxXeIE6Mp6neFxkhABigECvQ9"
ARK_ENDPOINT = "https://ark.cn-beijing.volces.com/api/v3/images/generations"
ARK_MODEL = "ep-20260228221135-66v8k"
```

### API è°ƒç”¨ç¤ºä¾‹
```bash
curl -X POST https://ark.cn-beijing.volces.com/api/v3/images/generations \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $ARK_API_KEY" \
  -d '{
    "model": "ep-20260228221135-66v8k",
    "prompt": "é«˜ç«¯äº§å“æ‘„å½±ï¼Œ8Kè¶…é«˜æ¸…",
    "sequential_image_generation": "disabled",
    "response_format": "url",
    "size": "4096x4096",
    "stream": false,
    "watermark": false
  }'
```

---

## ðŸ—ï¸ æœŸæœ›çš„Pipelineæž¶æž„ (ç«å±±å¼•æ“Žç‰ˆæœ¬)

```
è¾“å…¥å›¾åƒ (720p-1080p)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: å›¾åƒåˆ†æž                       â”‚
â”‚  - å†…å®¹è¯†åˆ«ï¼ˆäº§å“/äººåƒ/é£Žæ™¯ï¼‰             â”‚
â”‚  - è´¨é‡è¯„ä¼°                               â”‚
â”‚  - ç¡®å®šè¶…åˆ†ç­–ç•¥                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: æ™ºèƒ½åˆ†å—                       â”‚
â”‚  - åŸºäºŽå†…å®¹çš„åˆ†å—                         â”‚
â”‚  - ä¿æŠ¤å…³é”®åŒºåŸŸï¼ˆäººè„¸/æ–‡å­—ï¼‰              â”‚
â”‚  - è®¡ç®—é‡å åŒºåŸŸ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 3: ç«å±±å¼•æ“ŽSeedreamè¶…åˆ†          â”‚
â”‚  - æž„å»ºPromptï¼ˆåŸºäºŽå†…å®¹ç±»åž‹ï¼‰             â”‚
â”‚  - è°ƒç”¨Seedream 4.0 API                   â”‚
â”‚  - ç”Ÿæˆé«˜ç»†èŠ‚å›¾åƒ (4096x4096)             â”‚
â”‚  - é£Žæ ¼ä¸€è‡´æ€§æŽ§åˆ¶ï¼ˆç§å­é”å®šï¼‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 4: æ™ºèƒ½èžåˆ                       â”‚
â”‚  - æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”èžåˆ                     â”‚
â”‚  - æŽ¥ç¼æ¶ˆé™¤                               â”‚
â”‚  - é¢œè‰²ä¸€è‡´æ€§æ ¡æ­£                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 5: åŽå¤„ç†å¢žå¼º                     â”‚
â”‚  - é”åŒ–                                   â”‚
â”‚  - å¯¹æ¯”åº¦è°ƒæ•´                             â”‚
â”‚  - æœ€ç»ˆè´¨é‡æ£€æŸ¥                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¾“å‡ºå›¾åƒ (100MP-200MP TIFF)
```

---

## ðŸ”§ å…³é”®é›†æˆç‚¹

### 1. Seedream 4.0 API è°ƒç”¨

**æ–‡ä»¶**: `super_resolution_module.py`

**éœ€è¦å®žçŽ°çš„åŠŸèƒ½**:
```python
async def upscale_seedream(
    self,
    image: Union[str, Image.Image, np.ndarray],
    prompt: str,
    strength: float = 0.5,
    size: str = "4096x4096",
    num_inference_steps: int = 50,
    seed: Optional[int] = None
) -> SuperResolutionResult:
    """
    ä½¿ç”¨Seedream 4.0è¿›è¡ŒAIè¶…åˆ†
    
    Args:
        image: è¾“å…¥å›¾åƒï¼ˆä½Žåˆ†è¾¨çŽ‡å—ï¼‰
        prompt: æè¿°å›¾åƒå†…å®¹å’Œè´¨é‡è¦æ±‚çš„æç¤ºè¯
        strength: ç”Ÿæˆå¼ºåº¦ (0.0-1.0)
        size: è¾“å‡ºå°ºå¯¸ (å¦‚ "4096x4096")
        num_inference_steps: æŽ¨ç†æ­¥æ•° (è¶Šå¤šç»†èŠ‚è¶Šä¸°å¯Œ)
        seed: éšæœºç§å­ï¼ˆä¿æŒä¸€è‡´æ€§ï¼‰
    
    Returns:
        SuperResolutionResult: åŒ…å«è¶…åˆ†åŽçš„å›¾åƒ
    """
```

**Promptæž„å»ºç­–ç•¥**:
```python
def build_prompt(
    category: str,           # ç±»åˆ«: beauty/3c/food/fashion/jewelry
    subject_desc: str,       # ä¸»ä½“æè¿°
    quality_level: str = "8K",  # è´¨é‡ç­‰çº§
    style: str = "commercial"   # é£Žæ ¼
) -> str:
    """
    æž„å»ºSeedreamå¯ç”¨çš„Prompt
    
    ç¤ºä¾‹è¾“å‡º:
    "é«˜ç«¯åŒ–å¦†å“å•†ä¸šæ‘„å½±ï¼ŒæŸ”å…‰æ£šæ‹ï¼Œ8Kè¶…é«˜æ¸…ï¼Œ
     ç»†è…»è‚¤è´¨ï¼Œä¸“ä¸šå¹¿å‘Šå“è´¨ï¼Œæ— å™ªç‚¹ï¼Œ
     é”åˆ©è¾¹ç¼˜ï¼Œç²¾ç¡®è‰²å½©è¿˜åŽŸï¼Œå°åˆ·çº§ç²¾åº¦"
    """
```

### 2. é£Žæ ¼ä¸€è‡´æ€§æŽ§åˆ¶

**å…³é”®**: æ‰€æœ‰å—ä½¿ç”¨ç›¸åŒçš„seedï¼Œç¡®ä¿æ•´ä½“é£Žæ ¼ç»Ÿä¸€

```python
# å…¨å±€ç§å­
GLOBAL_SEED = 42

# æ¯ä¸ªå—ä½¿ç”¨ç›¸åŒç§å­
for tile in tiles:
    result = await upscale_seedream(
        image=tile,
        prompt=prompt,
        seed=GLOBAL_SEED,  # ä¿æŒä¸€è‡´æ€§
        ...
    )
```

### 3. å¤šçº§è¶…åˆ†ç­–ç•¥

**é—®é¢˜**: Seedreamæœ€å¤§è¾“å‡º4096x4096ï¼Œè¦è¾¾åˆ°100MPéœ€è¦å¤šæ¬¡æ”¾å¤§

**æ–¹æ¡ˆ**:
```python
async def multi_stage_upscale(
    image: Image.Image,
    target_scale: float
) -> Image.Image:
    """
    å¤šçº§è¶…åˆ†: 2x â†’ 2x â†’ 2x (æ¯”ç›´æŽ¥8xæ•ˆæžœæ›´å¥½)
    """
    current = image
    current_scale = 1.0
    
    while current_scale < target_scale:
        stage_scale = min(2.0, target_scale / current_scale)
        
        # åˆ†å—
        tiles = split_image(current)
        
        # æ¯å—ç”¨Seedreamè¶…åˆ†
        upscaled_tiles = []
        for tile in tiles:
            result = await upscale_seedream(tile, prompt, seed=GLOBAL_SEED)
            upscaled_tiles.append(result)
        
        # èžåˆ
        current = blend_tiles(upscaled_tiles)
        current_scale *= stage_scale
    
    return current
```

---

## ðŸ“‹ API å‚æ•°ä¼˜åŒ–

### Seedream 4.0 å‚æ•°

| å‚æ•° | æŽ¨èå€¼ | è¯´æ˜Ž |
|------|-------|------|
| `strength` | 0.4-0.6 | å¤ªä½Ž=ç»†èŠ‚ä¸è¶³ï¼Œå¤ªé«˜=å¤±çœŸ |
| `num_inference_steps` | 50-100 | è¶Šå¤šç»†èŠ‚è¶Šå¥½ï¼Œä½†è¶Šæ…¢ |
| `size` | "4096x4096" | æœ€å¤§è¾“å‡ºå°ºå¯¸ |
| `seed` | å›ºå®šå€¼ | ä¿æŒä¸€è‡´æ€§ |
| `watermark` | false | å•†ä¸šç”¨é€”ä¸éœ€è¦æ°´å° |

### è¯·æ±‚ç¤ºä¾‹

```json
{
  "model": "ep-20260228221135-66v8k",
  "prompt": "é«˜ç«¯å¥¢ä¾ˆå“æ‰‹è¡¨å¹¿å‘Šæ‘„å½±ï¼Œç²¾è‡´æœºæ¢°è¡¨ç›˜ï¼Œé‡‘è‰²è¡¨å¸¦ï¼Œé»‘è‰²èƒŒæ™¯ï¼Œä¸“ä¸šæ£šæ‹ç¯å…‰ï¼Œé‡‘å±žè´¨æ„Ÿï¼Œ8Kè¶…é«˜æ¸…ï¼Œä¸“ä¸šå¹¿å‘Šå“è´¨ï¼Œé”åˆ©è¾¹ç¼˜ï¼Œå°åˆ·çº§ç²¾åº¦",
  "sequential_image_generation": "disabled",
  "response_format": "url",
  "size": "4096x4096",
  "stream": false,
  "watermark": false,
  "seed": 42
}
```

---

## ðŸ› å·²çŸ¥é—®é¢˜

### APIè®¤è¯å¤±è´¥ (401 Unauthorized)
```
{"error":{"code":"AuthenticationError",
  "message":"The API key format is incorrect"}}
```

**å¯èƒ½åŽŸå› **:
1. API Keyæ ¼å¼ä¸æ­£ç¡®
2. é…é¢å·²ç”¨å®Œ
3. æ¨¡åž‹IDé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥API Keyæ˜¯å¦ä¸ºå®Œæ•´å­—ç¬¦ä¸²
2. åœ¨ç«å±±å¼•æ“ŽæŽ§åˆ¶å°æŸ¥çœ‹é…é¢
3. éªŒè¯æ¨¡åž‹æŽ¥å…¥ç‚¹ID

---

## ðŸŽ¯ ä¼˜åŒ–å»ºè®®

### çŸ­æœŸ (1-2å‘¨)
1. **ä¿®å¤APIè®¤è¯** - ç¡®ä¿å¯ä»¥æ­£å¸¸è°ƒç”¨Seedream
2. **å®žçŽ°åŸºç¡€Pipeline** - åˆ†å—â†’è¶…åˆ†â†’èžåˆ
3. **æ·»åŠ é”™è¯¯é‡è¯•** - ç½‘ç»œå¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•

### ä¸­æœŸ (1ä¸ªæœˆ)
1. **ä¼˜åŒ–Promptå·¥ç¨‹** - é’ˆå¯¹ä¸åŒå†…å®¹ç±»åž‹ä¼˜åŒ–æç¤ºè¯
2. **å®žçŽ°å¤šçº§è¶…åˆ†** - 2xâ†’2xâ†’2xæ¸è¿›å¼æ”¾å¤§
3. **å®Œå–„èžåˆç®—æ³•** - çœŸæ­£çš„æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”èžåˆ

### é•¿æœŸ (2-3ä¸ªæœˆ)
1. **æ™ºèƒ½å†…å®¹åˆ†æž** - è‡ªåŠ¨è¯†åˆ«å›¾åƒç±»åž‹ï¼Œé€‰æ‹©æœ€ä½³ç­–ç•¥
2. **è´¨é‡åé¦ˆå¾ªçŽ¯** - æ ¹æ®è´¨é‡è¯„ä¼°ç»“æžœè°ƒæ•´å‚æ•°
3. **æ‰¹é‡å¤„ç†ä¼˜åŒ–** - å¤šå›¾å¹¶è¡Œå¤„ç†

---

## ðŸ“š å‚è€ƒèµ„æ–™

- ç«å±±å¼•æ“ŽARKæ–‡æ¡£: https://www.volcengine.com/docs/82379/1302008
- Seedream 4.0ä»‹ç»: https://www.volcengine.com/docs/82379/
- APIå¯†é’¥ç®¡ç†: https://console.volcengine.com/iam/keymanage/

---

## ðŸ“ž æ”¯æŒ

å¦‚æœ‰APIé—®é¢˜ï¼Œè¯·è”ç³»:
- ç«å±±å¼•æ“ŽæŠ€æœ¯æ”¯æŒ
- APIæ–‡æ¡£: https://www.volcengine.com/docs/

---

*æœ¬æ–‡æ¡£ä¸ºDeepResearchä¼˜åŒ–å‚è€ƒ*
